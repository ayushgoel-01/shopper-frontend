{"ast":null,"code":"import React,{createContext,useEffect,useState}from\"react\";import{base_url}from\"../config\";import{jsx as _jsx}from\"react/jsx-runtime\";export const ShopContext=/*#__PURE__*/createContext(null);const getDefaultCart=()=>{let cart={};for(let index=0;index<300+1;index++){cart[index]=0;}return cart;};const ShopContextProvider=props=>{const[all_product,setAll_Product]=useState([]);const[cartItems,setCartItems]=useState(getDefaultCart());useEffect(()=>{fetch(\"\".concat(base_url,\"/allproducts\")).then(response=>response.json()).then(data=>setAll_Product(data));if(localStorage.getItem('auth-token')){fetch(\"'\".concat(base_url,\"/getcart\"),{method:'POST',headers:{Accept:'application/form-data','auth-token':\"\".concat(localStorage.getItem('auth-token')),'Content-Type':'application/json'},body:\"\"}).then(response=>response.json()).then(data=>setCartItems(data));}},[]);const addToCart=itemId=>{setCartItems(prev=>({...prev,[itemId]:prev[itemId]+1}));if(localStorage.getItem('auth-token')){fetch(\"\".concat(base_url,\"/addtocart\"),{method:'POST',headers:{Accept:'application/form-data','auth-token':\"\".concat(localStorage.getItem('auth-token')),'Content-Type':'application/json'},body:JSON.stringify({\"itemId\":itemId})}).then(response=>response.json()).then(data=>console.log(data));}};const removeFromCart=itemId=>{setCartItems(prev=>({...prev,[itemId]:prev[itemId]-1}));if(localStorage.getItem('auth-token')){fetch(\"\".concat(base_url,\"/removefromcart\"),{method:'POST',headers:{Accept:'application/form-data','auth-token':\"\".concat(localStorage.getItem('auth-token')),'Content-Type':'application/json'},body:JSON.stringify({\"itemId\":itemId})}).then(response=>response.json()).then(data=>console.log(data));}};const getTotalCartAmount=()=>{let totalAmount=0;for(const item in cartItems){if(cartItems[item]>0){let itemInfo=all_product.find(product=>product.id===Number(item));totalAmount+=itemInfo.new_price*cartItems[item];}}return totalAmount;};const getTotalCartItems=()=>{let totalItem=0;for(const item in cartItems){if(cartItems[item]>0){totalItem+=cartItems[item];}}return totalItem;};const contextValue={getTotalCartItems,getTotalCartAmount,all_product,cartItems,addToCart,removeFromCart};return/*#__PURE__*/_jsx(ShopContext.Provider,{value:contextValue,children:props.children});};export default ShopContextProvider;","map":{"version":3,"names":["React","createContext","useEffect","useState","base_url","jsx","_jsx","ShopContext","getDefaultCart","cart","index","ShopContextProvider","props","all_product","setAll_Product","cartItems","setCartItems","fetch","concat","then","response","json","data","localStorage","getItem","method","headers","Accept","body","addToCart","itemId","prev","JSON","stringify","console","log","removeFromCart","getTotalCartAmount","totalAmount","item","itemInfo","find","product","id","Number","new_price","getTotalCartItems","totalItem","contextValue","Provider","value","children"],"sources":["/Users/ayushgoel/Desktop/E-Commerce/frontend/src/Context/ShopContext.jsx"],"sourcesContent":["import React, {createContext, useEffect, useState} from \"react\";\nimport { base_url } from \"../config\";\n\nexport const ShopContext = createContext(null);\n\nconst getDefaultCart = () => {\n    let cart = {};\n    for (let index=0; index<300+1; index++){\n        cart[index] = 0;\n    }\n    return cart;\n}\n\nconst ShopContextProvider = (props) => {\n\n    const [all_product,setAll_Product] = useState([]);\n\n    const [cartItems,setCartItems] = useState(getDefaultCart());\n\n    useEffect(()=>{\n        fetch(`${base_url}/allproducts`).then((response)=>response.json()).then((data)=>setAll_Product(data))\n\n        if(localStorage.getItem('auth-token')){\n            fetch(`'${base_url}/getcart`,{\n                method:'POST',\n                headers:{\n                    Accept:'application/form-data',\n                    'auth-token':`${localStorage.getItem('auth-token')}`,\n                    'Content-Type':'application/json',\n                },\n                body:\"\",\n            }).then((response)=>response.json()).then((data)=>setCartItems(data));\n        }\n\n    },[])\n\n    const addToCart = (itemId) => {\n        setCartItems((prev) => ({...prev,[itemId]:prev[itemId]+1}));\n       if(localStorage.getItem('auth-token')){\n            fetch(`${base_url}/addtocart`,{\n                method:'POST',\n                headers:{\n                    Accept:'application/form-data',\n                    'auth-token':`${localStorage.getItem('auth-token')}`,\n                    'Content-Type':'application/json',\n                },\n                body:JSON.stringify({\"itemId\":itemId}),\n            }).then((response)=>response.json()).then((data)=>console.log(data));\n       }\n    }\n\n    const removeFromCart = (itemId) => {\n        setCartItems((prev) => ({...prev,[itemId]:prev[itemId]-1}));\n        if(localStorage.getItem('auth-token')){\n            fetch(`${base_url}/removefromcart`,{\n                method:'POST',\n                headers:{\n                    Accept:'application/form-data',\n                    'auth-token':`${localStorage.getItem('auth-token')}`,\n                    'Content-Type':'application/json',\n                },\n                body:JSON.stringify({\"itemId\":itemId}),\n            }).then((response)=>response.json()).then((data)=>console.log(data));\n        }\n    }\n\n    const getTotalCartAmount = () =>{\n        let totalAmount = 0;\n        for(const item in cartItems){\n            if(cartItems[item] > 0){\n                let itemInfo = all_product.find((product)=>product.id===Number(item));\n                totalAmount += itemInfo.new_price * cartItems[item];\n            }\n        }\n        return totalAmount;\n    }\n\n    const getTotalCartItems = () =>{\n        let totalItem = 0;\n        for(const item in cartItems){\n            if(cartItems[item] > 0){\n                totalItem += cartItems[item];\n            }\n        }\n        return totalItem;\n    }\n\n    const contextValue = {getTotalCartItems,getTotalCartAmount,all_product,cartItems,addToCart,removeFromCart};\n\n    return (\n        <ShopContext.Provider value={contextValue}>\n        {props.children}\n        </ShopContext.Provider>\n    )\n}\n\nexport default ShopContextProvider;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}